# Quickstart Guide: è·¨å¹³å°è£ç½®é›»é‡ç›£æ§å·¥å…·

**Feature**: 001- è·¨å¹³å°è£ç½®é›»é‡ç›£æ§å·¥å…·
**Date**: 2025-10-07
**Purpose**: å¿«é€Ÿé©—è­‰åŠŸèƒ½å¯¦ä½œæ˜¯å¦ç¬¦åˆè¦æ ¼è¦æ±‚

---

## æ¦‚è¿°

æœ¬æ–‡ä»¶æä¾›ç«¯åˆ°ç«¯æ¸¬è©¦å ´æ™¯,ç”¨æ–¼é©—è­‰ç³»çµ±åŠŸèƒ½æ˜¯å¦ç¬¦åˆ [spec.md](./spec.md) å®šç¾©çš„æ‰€æœ‰åŠŸèƒ½éœ€æ±‚èˆ‡é©—æ”¶æ¨™æº–ã€‚

**æ¸¬è©¦ç¯„åœ**:
- âœ… æœ¬åœ°é›»é‡è®€å– (FR-001, FR-002)
- âœ… è·¨å¹³å°æ”¯æ´ (FR-003)
- âœ… P2P é€£ç·šèˆ‡åŠ å¯† (FR-013)
- âœ… ä¸­ç¹¼ä¼ºæœå™¨é™ç´š (FR-013)
- âœ… æ­·å²è¨˜éŒ„å„²å­˜ (FR-015)
- âœ… è£ç½®èº«ä»½ç®¡ç† (FR-012, FR-017)
- âœ… éŒ¯èª¤è™•ç† (FR-009, FR-010)

---

## å‰ç½®æº–å‚™

### ç’°å¢ƒéœ€æ±‚

**é–‹ç™¼ç’°å¢ƒ**:
- Flutter 3.24+
- Dart 3.5+
- Rust 1.75+ (ç”¨æ–¼ FFI æ¨¡çµ„)
- Xcode 15+ (macOS/iOS é–‹ç™¼)
- Android Studio (Android é–‹ç™¼)

**åŸ·è¡Œç’°å¢ƒ**:
- Windows 10+ / macOS 11+ / Android 10+ / iPadOS 14+
- ç¶²è·¯é€£ç·š (ç”¨æ–¼æ¸¬è©¦ P2P èˆ‡ä¸­ç¹¼æ¨¡å¼)

**ä¿¡ä»¤ä¼ºæœå™¨**:
```bash
# å•Ÿå‹•æœ¬åœ°æ¸¬è©¦ä¼ºæœå™¨
cd signaling-server
cargo run --release

# é è¨­ç›£è½ ws://localhost:8080/signaling
```

**TURN ä¼ºæœå™¨** (å¯é¸,æ¸¬è©¦ä¸­ç¹¼æ¨¡å¼æ™‚éœ€è¦):
```bash
# å•Ÿå‹• coturn
turnserver -c turnserver.conf
```

---

## å ´æ™¯ 1: æœ¬åœ°é›»é‡è®€å–

**å°æ‡‰éœ€æ±‚**: FR-001, FR-002, FR-003, FR-009

**æ­¥é©Ÿ**:
1. åœ¨æœ¬åœ°è£ç½®å•Ÿå‹•æ‡‰ç”¨
2. æª¢æŸ¥ UI é¡¯ç¤ºæœ¬åœ°è£ç½®é›»é‡ç™¾åˆ†æ¯”
3. æª¢æŸ¥å……é›»ç‹€æ…‹é¡¯ç¤º (å……é›»ä¸­/æœªå……é›»/å·²å……æ»¿)

**é æœŸçµæœ**:
```dart
// æœ‰é›»æ± çš„è£ç½® (ç­†é›»ã€æ‰‹æ©Ÿã€å¹³æ¿)
BatteryStatus {
  deviceId: "æœ¬åœ°è£ç½® UUID",
  batteryLevel: 0-100,
  chargingState: ChargingState.charging/discharging/full,
  powerType: PowerType.battery,
}

// ç´”é›»æºä¾›é›»è£ç½® (æ¡Œæ©Ÿã€è™›æ“¬æ©Ÿ)
BatteryStatus {
  deviceId: "æœ¬åœ°è£ç½® UUID",
  batteryLevel: -1, // AC_POWER
  chargingState: ChargingState.unknown,
  powerType: PowerType.acOnly,
}
```

**é©—è­‰å‘½ä»¤**:
```bash
# Flutter æ•´åˆæ¸¬è©¦
flutter test integration_test/battery_reading_test.dart

# é æœŸè¼¸å‡º
# âœ… æœ¬åœ°é›»é‡è®€å–æˆåŠŸ
# âœ… å……é›»ç‹€æ…‹æ­£ç¢ºé¡¯ç¤º
# âœ… AC é›»æºè£ç½®é¡¯ç¤ºã€ŒACé›»æºã€
```

**é‚Šç·£æ¡ˆä¾‹æ¸¬è©¦**:
- [ ] åœ¨è™›æ“¬æ©Ÿä¸ŠåŸ·è¡Œ,é©—è­‰é¡¯ç¤ºã€ŒACé›»æºã€
- [ ] æ’æ‹”å……é›»å™¨,é©—è­‰ç‹€æ…‹å³æ™‚æ›´æ–°
- [ ] åœ¨ Android ä¸Šæ¸¬è©¦,ç¢ºèª BatteryManager API æ­£å¸¸é‹ä½œ

---

## å ´æ™¯ 2: è£ç½®åˆå§‹åŒ–èˆ‡é‡‘é‘°ç”Ÿæˆ

**å°æ‡‰éœ€æ±‚**: FR-012, FR-017

**æ­¥é©Ÿ**:
1. é¦–æ¬¡å•Ÿå‹•æ‡‰ç”¨
2. æ‡‰ç”¨è‡ªå‹•ç”Ÿæˆ Ed25519 é‡‘é‘°å°
3. é¡¯ç¤º 24 å€‹ BIP39 åŠ©è¨˜è©,è¦æ±‚ä½¿ç”¨è€…æŠ„å¯«
4. é©—è­‰ä½¿ç”¨è€…å·²æŠ„å¯« (è¼¸å…¥éƒ¨åˆ†åŠ©è¨˜è©ç¢ºèª)
5. é‡‘é‘°å„²å­˜è‡³å¹³å°é‡‘é‘°éˆ

**é æœŸçµæœ**:
```dart
// ç”Ÿæˆçš„èº«ä»½è³‡è¨Š
Device {
  deviceId: "UUID v4",
  deviceName: "ä½¿ç”¨è€…è£ç½®åç¨± (å¯ç·¨è¼¯)",
  publicKey: "64 å­—å…ƒ hex å­—ä¸²",
  platform: Platform.macos/windows/android/ipados,
  powerType: PowerType.battery/acOnly,
  isLocal: true,
}

// ç§é‘°å„²å­˜ä½ç½®
flutter_secure_storage:
  - key: "device_private_key"
  - value: "64 å­—å…ƒ hex ç§é‘°"
  - key: "backup_mnemonic"
  - value: "24 å€‹åŠ©è¨˜è© (ç©ºæ ¼åˆ†éš”)"
```

**é©—è­‰å‘½ä»¤**:
```bash
# å–®å…ƒæ¸¬è©¦
flutter test test/crypto_service_test.dart

# é æœŸè¼¸å‡º
# âœ… Ed25519 é‡‘é‘°å°ç”ŸæˆæˆåŠŸ
# âœ… BIP39 åŠ©è¨˜è©æœ‰æ•ˆ (24 å€‹è‹±æ–‡å–®å­—)
# âœ… ç§é‘°å„²å­˜è‡³é‡‘é‘°éˆ
# âœ… å¾åŠ©è¨˜è©æ¢å¾©é‡‘é‘°å°æˆåŠŸ
```

**æ‰‹å‹•æ¸¬è©¦**:
- [ ] åœ¨ macOS ä¸Š,ä½¿ç”¨ Keychain Access æŸ¥çœ‹ç§é‘°
- [ ] åœ¨ Android ä¸Š,ç¢ºèªç§é‘°å„²å­˜åœ¨ Keystore
- [ ] é‡æ–°å®‰è£æ‡‰ç”¨,æ¸¬è©¦ã€Œå¾åŠ©è¨˜è©æ¢å¾©ã€åŠŸèƒ½

---

## å ´æ™¯ 3: P2P é€£ç·šå»ºç«‹

**å°æ‡‰éœ€æ±‚**: FR-013, FR-004

**æ­¥é©Ÿ**:
1. å•Ÿå‹•å…©å€‹è£ç½® (A èˆ‡ B),å…©è€…åœ¨åŒä¸€å€åŸŸç¶²è·¯
2. è£ç½® A èˆ‡ B åˆ†åˆ¥è¨»å†Šè‡³ä¿¡ä»¤ä¼ºæœå™¨
3. è£ç½® A ç™¼é€é€£ç·šè«‹æ±‚è‡³è£ç½® B
4. é©—è­‰ WebRTC Offer/Answer äº¤æ›
5. é©—è­‰ Noise Protocol æ¡æ‰‹å®Œæˆ
6. é©—è­‰ P2P DataChannel å»ºç«‹æˆåŠŸ

**é æœŸçµæœ**:
```dart
// ConnectionInfo (è£ç½® B åœ¨è£ç½® A çš„è³‡æ–™åº«)
ConnectionInfo {
  deviceId: "è£ç½® B UUID",
  connectionState: ConnectionState.connected,
  connectionType: ConnectionType.p2p, // P2P ç›´é€£
  lastConnectedAt: DateTime.now(),
  noiseSessionState: "åºåˆ—åŒ–çš„ Noise æœƒè©±ç‹€æ…‹",
}
```

**é©—è­‰å‘½ä»¤**:
```bash
# æ•´åˆæ¸¬è©¦
flutter test integration_test/p2p_connection_test.dart

# é æœŸè¼¸å‡º
# âœ… ä¿¡ä»¤ä¼ºæœå™¨é€£ç·šæˆåŠŸ
# âœ… WebRTC Offer/Answer äº¤æ›æˆåŠŸ
# âœ… ICE å€™é¸äº¤æ›æˆåŠŸ
# âœ… Noise_XX æ¡æ‰‹å®Œæˆ
# âœ… P2P DataChannel ç‹€æ…‹: open
```

**ç¶²è·¯æŠ“åŒ…é©—è­‰** (ç¢ºèªåŠ å¯†):
```bash
# ä½¿ç”¨ Wireshark æŠ“å– WebRTC æµé‡
# é æœŸçœ‹åˆ°:
# - DTLS åŠ å¯†çš„ WebRTC æµé‡ (ç„¡æ³•è§£å¯†)
# - ç„¡æ˜æ–‡é›»é‡è³‡æ–™
```

**æ•ˆèƒ½é©—è­‰**:
- [ ] P2P é€£ç·šå»ºç«‹æ™‚é–“ < 2 ç§’ (ç¬¦åˆ Performance Goals)
- [ ] DataChannel å»¶é² < 50ms (å€åŸŸç¶²è·¯)

---

## å ´æ™¯ 4: ä¸­ç¹¼ä¼ºæœå™¨é™ç´š

**å°æ‡‰éœ€æ±‚**: FR-013

**æ­¥é©Ÿ**:
1. å•Ÿå‹•å…©å€‹è£ç½® (A èˆ‡ B),å…©è€…åœ¨ä¸åŒç¶²è·¯ (æ¨¡æ“¬ NAT é˜»æ“‹)
2. è£ç½® A å˜—è©¦ P2P é€£ç·šè‡³è£ç½® B
3. P2P ç›´é€£å¤±æ•—å¾Œ,è‡ªå‹•è«‹æ±‚ TURN æ†‘è­‰
4. ä½¿ç”¨ TURN ä¸­ç¹¼ä¼ºæœå™¨è½‰ç™¼æµé‡
5. é©—è­‰è³‡æ–™ä»ç‚ºåŠ å¯†ç‹€æ…‹ (ä¼ºæœå™¨ç„¡æ³•è§£å¯†)

**é æœŸçµæœ**:
```dart
ConnectionInfo {
  deviceId: "è£ç½® B UUID",
  connectionState: ConnectionState.connected,
  connectionType: ConnectionType.relay, // ä¸­ç¹¼æ¨¡å¼
  lastConnectedAt: DateTime.now(),
}
```

**é©—è­‰å‘½ä»¤**:
```bash
# æ¨¡æ“¬ NAT é˜»æ“‹
# åœ¨é˜²ç«ç‰†è¦å‰‡ä¸­é˜»æ“‹ UDP 3478 ç«¯å£ (WebRTC)

flutter test integration_test/relay_fallback_test.dart

# é æœŸè¼¸å‡º
# âœ… P2P ç›´é€£å¤±æ•—
# âœ… è«‹æ±‚ TURN æ†‘è­‰æˆåŠŸ
# âœ… TURN ä¸­ç¹¼é€£ç·šå»ºç«‹æˆåŠŸ
# âœ… å»¶é² < 500ms (ç¬¦åˆ Performance Goals)
```

**TURN ä¼ºæœå™¨æ—¥èªŒé©—è­‰**:
```
# coturn æ—¥èªŒæ‡‰é¡¯ç¤º:
# - è£ç½® A èˆ‡ B é€é TURN è½‰ç™¼æµé‡
# - æµé‡ç‚ºåŠ å¯†ç‹€æ…‹ (DTLS)
# - TURN ä¼ºæœå™¨ç„¡æ³•è§£å¯†å…§å®¹
```

---

## å ´æ™¯ 5: é›»é‡è³‡æ–™å‚³è¼¸

**å°æ‡‰éœ€æ±‚**: FR-005, FR-006, FR-015

**æ­¥é©Ÿ**:
1. è£ç½® A èˆ‡ B å·²å»ºç«‹ P2P é€£ç·š
2. è£ç½® A æ¯ 5 åˆ†é˜ç™¼é€é›»é‡è³‡æ–™è‡³è£ç½® B
3. è£ç½® B æ¥æ”¶è³‡æ–™,è§£å¯†å¾Œå„²å­˜è‡³ Isar è³‡æ–™åº«
4. é©—è­‰æ­·å²è¨˜éŒ„æ­£ç¢ºå„²å­˜

**å‚³è¼¸è³‡æ–™æ ¼å¼** (Noise åŠ å¯†å‰):
```json
{
  "type": "battery_update",
  "device_id": "è£ç½® A UUID",
  "battery_level": 85,
  "charging_state": "discharging",
  "timestamp": "2025-10-07T14:30:00Z"
}
```

**é æœŸçµæœ**:
```dart
// è£ç½® B çš„ Isar è³‡æ–™åº«
BatteryHistory {
  deviceId: "è£ç½® A UUID",
  batteryLevel: 85,
  chargingState: ChargingState.discharging,
  timestamp: DateTime.parse("2025-10-07T14:30:00Z"),
  source: DataSource.remoteP2P, // ä¾†è‡ª P2P
}
```

**é©—è­‰å‘½ä»¤**:
```bash
flutter test integration_test/battery_sync_test.dart

# é æœŸè¼¸å‡º
# âœ… æ¯ 5 åˆ†é˜ç™¼é€é›»é‡è³‡æ–™
# âœ… è³‡æ–™åŠ å¯†å‚³è¼¸ (Noise Protocol)
# âœ… æ¥æ”¶æ–¹æˆåŠŸè§£å¯†
# âœ… æ­·å²è¨˜éŒ„å„²å­˜æˆåŠŸ
# âœ… æŸ¥è©¢æ­·å²è¨˜éŒ„ < 100ms (ç¬¦åˆ Performance Goals)
```

**è³‡æ–™åº«é©—è­‰**:
```dart
// æŸ¥è©¢è£ç½® A çš„æ­·å²è¨˜éŒ„
final history = await isar.batteryHistorys
  .filter()
  .deviceIdEqualTo("è£ç½® A UUID")
  .sortByTimestampDesc()
  .findAll();

// é æœŸ:
// - æ¯ 5 åˆ†é˜æœ‰ä¸€ç­†è¨˜éŒ„
// - timestamp æ­£ç¢ºæ’åº
// - source ç‚º DataSource.remoteP2P
```

---

## å ´æ™¯ 6: æ–·ç·šé‡é€£

**å°æ‡‰éœ€æ±‚**: FR-010

**æ­¥é©Ÿ**:
1. è£ç½® A èˆ‡ B å·²å»ºç«‹é€£ç·š
2. æ¨¡æ“¬ç¶²è·¯ä¸­æ–· (é—œé–‰ Wi-Fi)
3. é©—è­‰è£ç½® A é€²å…¥é‡è©¦ç‹€æ…‹ (æŒ‡æ•¸é€€é¿)
4. æ¢å¾©ç¶²è·¯
5. é©—è­‰è‡ªå‹•é‡é€£æˆåŠŸ

**é æœŸç‹€æ…‹è½‰æ›**:
```
connected â†’ disconnected (ç¶²è·¯ä¸­æ–·)
          â†“
     retrying (5s å¾Œé¦–æ¬¡é‡è©¦)
          â†“
     retrying (10s å¾Œç¬¬äºŒæ¬¡é‡è©¦)
          â†“
     connected (é‡é€£æˆåŠŸ)
```

**é æœŸçµæœ**:
```dart
// æ–·ç·šå¾Œ
ConnectionInfo {
  connectionState: ConnectionState.retrying,
  retryCount: 3,
  nextRetryAt: DateTime.now().add(Duration(seconds: 20)),
}

// é‡é€£æˆåŠŸå¾Œ
ConnectionInfo {
  connectionState: ConnectionState.connected,
  retryCount: 0, // é‡ç½®
  lastConnectedAt: DateTime.now(),
}
```

**é©—è­‰å‘½ä»¤**:
```bash
flutter test integration_test/reconnection_test.dart

# é æœŸè¼¸å‡º
# âœ… æ–·ç·šå¾Œé€²å…¥ retrying ç‹€æ…‹
# âœ… é‡è©¦é–“éš”ç¬¦åˆæŒ‡æ•¸é€€é¿ (5s, 10s, 20s, ...)
# âœ… é‡é€£æˆåŠŸå¾Œé‡ç½® retryCount
# âœ… æŒçºŒé‡è©¦ç›´åˆ°é€£ç·šæˆåŠŸ (ç¬¦åˆ FR-010)
```

---

## å ´æ™¯ 7: å¤šè£ç½®ç›£æ§

**å°æ‡‰éœ€æ±‚**: FR-006, FR-007, FR-016

**æ­¥é©Ÿ**:
1. è£ç½® A é€£ç·šè‡³ 10 å°é ç«¯è£ç½® (B1-B10)
2. é©—è­‰ UI é¡¯ç¤ºæ‰€æœ‰è£ç½®åˆ—è¡¨
3. æ–°å¢ç¬¬ 11 å°è£ç½®,é©—è­‰é¡¯ç¤ºæé†’è¨Šæ¯
4. æŸ¥è©¢å„è£ç½®æœ€æ–°é›»é‡è³‡è¨Š

**é æœŸ UI é¡¯ç¤º**:
```
è£ç½®åˆ—è¡¨:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MacBook Pro (æœ¬æ©Ÿ)           85% âš¡å……é›»ä¸­ â”‚
â”‚ Samsung S23                  72% ğŸ”‹æ”¾é›»ä¸­ â”‚
â”‚ iPad Pro                     45% ğŸ”‹æ”¾é›»ä¸­ â”‚
â”‚ ... (å…± 10 å°)                            â”‚
â”‚                                          â”‚
â”‚ [æ–°å¢è£ç½®] â† æ–°å¢ç¬¬ 11 å°æ™‚é¡¯ç¤ºæé†’       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸ æé†’:æ‚¨å·²ç›£æ§è¶…é 10 å°è£ç½®,å¯èƒ½å½±éŸ¿æ•ˆèƒ½
```

**é©—è­‰å‘½ä»¤**:
```bash
flutter test integration_test/multi_device_test.dart

# é æœŸè¼¸å‡º
# âœ… æ”¯æ´ç„¡ä¸Šé™è£ç½®æ•¸ (æ¸¬è©¦ 20 å°)
# âœ… ç¬¬ 11 å°è£ç½®æ–°å¢æ™‚é¡¯ç¤ºæé†’
# âœ… æŸ¥è©¢æ‰€æœ‰è£ç½®é›»é‡ < 500ms
# âœ… UI æµæš¢åº¦ 60 FPS
```

**æ•ˆèƒ½ç›£æ§**:
```bash
# ä½¿ç”¨ Flutter DevTools ç›£æ§
# - è¨˜æ†¶é«”ä½”ç”¨ < 100MB (10 å°è£ç½®)
# - CPU ä½¿ç”¨ç‡ < 10% (èƒŒæ™¯é‹è¡Œ)
# - UI æ¸²æŸ“å¹€ç‡ 60 FPS
```

---

## å ´æ™¯ 8: æ­·å²è¨˜éŒ„æŸ¥è©¢

**å°æ‡‰éœ€æ±‚**: FR-015

**æ­¥é©Ÿ**:
1. æŸ¥è©¢è£ç½® A æœ€è¿‘ 30 å¤©çš„æ­·å²è¨˜éŒ„
2. é©—è­‰è¨˜éŒ„æ•¸é‡æ­£ç¢º (æ¯ 5 åˆ†é˜ä¸€ç­† â‰ˆ 8640 ç­†)
3. é©—è­‰æŸ¥è©¢æ•ˆèƒ½ < 100ms

**æŸ¥è©¢ç¯„ä¾‹**:
```dart
final thirtyDaysAgo = DateTime.now().subtract(Duration(days: 30));
final history = await storageService.getBatteryHistory(
  deviceId: 'xxx',
  startDate: thirtyDaysAgo,
);

// é æœŸçµæœ
print(history.length); // â‰ˆ 8640 ç­†
print(history.first.timestamp); // 30 å¤©å‰
print(history.last.timestamp); // ç¾åœ¨
```

**é©—è­‰å‘½ä»¤**:
```bash
flutter test test/storage_service_test.dart

# é æœŸè¼¸å‡º
# âœ… 30 å¤©æ­·å²è¨˜éŒ„æŸ¥è©¢ < 100ms
# âœ… è¨˜éŒ„æŒ‰æ™‚é–“æ­£åºæ’åˆ—
# âœ… è³‡æ–™å®Œæ•´æ€§é©—è­‰é€šé
```

**è³‡æ–™åº«æ•ˆèƒ½æ¸¬è©¦**:
```dart
// æ’å…¥ 10000 ç­†æ¸¬è©¦è³‡æ–™
final stopwatch = Stopwatch()..start();
for (var i = 0; i < 10000; i++) {
  await isar.batteryHistorys.put(testRecord);
}
stopwatch.stop();
print('æ’å…¥ 10000 ç­†è€—æ™‚: ${stopwatch.elapsedMilliseconds}ms');
// é æœŸ < 1000ms
```

---

## å ´æ™¯ 9: å®‰å…¨æ€§é©—è­‰

**å°æ‡‰éœ€æ±‚**: FR-012, FR-013, FR-014

**æ¸¬è©¦é …ç›®**:

### 9.1 ç§é‘°ä¿è­·
```bash
# é©—è­‰ç§é‘°ä¸å­˜åœ¨æ–¼ Isar è³‡æ–™åº«
flutter test test/security_test.dart

# é æœŸè¼¸å‡º
# âœ… ç§é‘°åƒ…å­˜åœ¨æ–¼é‡‘é‘°éˆ
# âœ… Isar è³‡æ–™åº«ä¸åŒ…å«ç§é‘°
# âœ… æ—¥èªŒä¸åŒ…å«ç§é‘°
```

### 9.2 åŠ å¯†é©—è­‰
```bash
# ä½¿ç”¨ Wireshark æŠ“åŒ…
# é æœŸçœ‹åˆ°:
# - WebRTC æµé‡ç‚º DTLS åŠ å¯†
# - ç„¡æ˜æ–‡é›»é‡è³‡æ–™
# - ç„¡ç§é‘°æ´©éœ²
```

### 9.3 ç°½ç« é©—è­‰
```dart
// æ¸¬è©¦å½é€ è¨Šæ¯
final fakeMessage = {
  'type': 'battery_update',
  'battery_level': 100,
};
final invalidSignature = 'invalid_signature';

// é æœŸçµæœ
final result = await cryptoService.verifySignature(
  message: fakeMessage,
  signature: invalidSignature,
  publicKey: devicePublicKey,
);
assert(result == false); // ç°½ç« é©—è­‰å¤±æ•—
```

---

## å ´æ™¯ 10: å¹³å°ç‰¹å®šæ¸¬è©¦

### Windows å¹³å°
```bash
# æ¸¬è©¦ WMI é›»æ±  API
flutter run -d windows

# é©—è­‰:
# - ç­†é›»æ­£ç¢ºé¡¯ç¤ºé›»é‡
# - æ¡Œæ©Ÿé¡¯ç¤ºã€ŒACé›»æºã€
# - å……é›»ç‹€æ…‹æ­£ç¢ºæ›´æ–°
```

### macOS å¹³å°
```bash
# æ¸¬è©¦ IOKit é›»æ±  API
flutter run -d macos

# é©—è­‰:
# - MacBook æ­£ç¢ºé¡¯ç¤ºé›»é‡
# - iMac é¡¯ç¤ºã€ŒACé›»æºã€
# - é‡‘é‘°å„²å­˜æ–¼ Keychain
```

### Android å¹³å°
```bash
# æ¸¬è©¦ BatteryManager API
flutter run -d android

# é©—è­‰:
# - æ‰‹æ©Ÿé›»é‡æ­£ç¢ºé¡¯ç¤º
# - å……é›»ç‹€æ…‹æ­£ç¢º
# - é‡‘é‘°å„²å­˜æ–¼ Keystore
# - èƒŒæ™¯ä»»å‹™æ­£å¸¸é‹è¡Œ
```

### iPadOS å¹³å°
```bash
# æ¸¬è©¦ UIDevice é›»æ±  API
flutter run -d ipad

# é©—è­‰:
# - iPad é›»é‡æ­£ç¢ºé¡¯ç¤º
# - é‡‘é‘°å„²å­˜æ–¼ Keychain
# - èƒŒæ™¯ä»»å‹™æ­£å¸¸é‹è¡Œ (å— iOS é™åˆ¶)
```

---

## è‡ªå‹•åŒ–æ¸¬è©¦åŸ·è¡Œ

**å®Œæ•´æ¸¬è©¦å¥—ä»¶**:
```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
./run_all_tests.sh

# åŒ…å«:
# - å–®å…ƒæ¸¬è©¦ (flutter test)
# - æ•´åˆæ¸¬è©¦ (flutter test integration_test/)
# - å¥‘ç´„æ¸¬è©¦ (é©—è­‰ API ä»‹é¢)
# - å¹³å°æ¸¬è©¦ (Windows/macOS/Android/iPadOS)
```

**é æœŸæ¸¬è©¦å ±å‘Š**:
```
âœ… å–®å…ƒæ¸¬è©¦: 120/120 é€šé
âœ… æ•´åˆæ¸¬è©¦: 45/45 é€šé
âœ… å¥‘ç´„æ¸¬è©¦: 15/15 é€šé
âœ… å¹³å°æ¸¬è©¦: 4/4 é€šé
âœ… ç¸½è¨ˆ: 184/184 é€šé
```

---

## ç–‘é›£æ’è§£

### å•é¡Œ 1: P2P é€£ç·šå¤±æ•—

**ç—‡ç‹€**: å…©å°è£ç½®ç„¡æ³•å»ºç«‹ P2P é€£ç·š

**æ’æŸ¥æ­¥é©Ÿ**:
1. æª¢æŸ¥é˜²ç«ç‰†æ˜¯å¦é˜»æ“‹ UDP æµé‡
2. æª¢æŸ¥ä¿¡ä»¤ä¼ºæœå™¨æ˜¯å¦æ­£å¸¸é‹è¡Œ
3. æª¢æŸ¥ ICE å€™é¸æ˜¯å¦äº¤æ›æˆåŠŸ
4. æª¢æŸ¥ STUN/TURN ä¼ºæœå™¨æ˜¯å¦å¯é”

**è§£æ±ºæ–¹æ¡ˆ**:
- é—œé–‰é˜²ç«ç‰†æˆ–é–‹æ”¾ UDP ç«¯å£
- ç¢ºèª TURN ä¼ºæœå™¨é…ç½®æ­£ç¢º

### å•é¡Œ 2: é›»é‡è®€å–å¤±æ•—

**ç—‡ç‹€**: batteryLevel é¡¯ç¤º -2 (READ_FAILED)

**æ’æŸ¥æ­¥é©Ÿ**:
1. æª¢æŸ¥å¹³å°æ¬Šé™ (Android éœ€ BATTERY_STATS æ¬Šé™)
2. æª¢æŸ¥ battery_plus ç‰ˆæœ¬æ˜¯å¦æœ€æ–°
3. æª¢æŸ¥è£ç½®æ˜¯å¦æ”¯æ´é›»æ±  API

**è§£æ±ºæ–¹æ¡ˆ**:
- åœ¨ AndroidManifest.xml åŠ å…¥æ¬Šé™
- æ›´æ–° battery_plus è‡³æœ€æ–°ç‰ˆ

---

## é©—æ”¶æ¸…å–®

æ ¹æ“š [spec.md](./spec.md) çš„é©—æ”¶æ¨™æº–,å®Œæˆä»¥ä¸‹æª¢æŸ¥:

- [ ] **å ´æ™¯ 1**: æœ¬åœ°è£ç½®é›»é‡æ­£ç¢ºé¡¯ç¤º (FR-001, FR-002)
- [ ] **å ´æ™¯ 2**: è£ç½®èº«ä»½æ­£ç¢ºç”Ÿæˆ,ç§é‘°å®‰å…¨å„²å­˜ (FR-012)
- [ ] **å ´æ™¯ 3**: P2P é€£ç·šæˆåŠŸå»ºç«‹,è³‡æ–™åŠ å¯†å‚³è¼¸ (FR-013)
- [ ] **å ´æ™¯ 4**: P2P å¤±æ•—æ™‚è‡ªå‹•é™ç´šè‡³ä¸­ç¹¼æ¨¡å¼ (FR-013)
- [ ] **å ´æ™¯ 5**: é›»é‡è³‡æ–™æ¯ 5 åˆ†é˜åŒæ­¥,æ­·å²è¨˜éŒ„å„²å­˜ (FR-005, FR-015)
- [ ] **å ´æ™¯ 6**: æ–·ç·šå¾Œè‡ªå‹•é‡é€£,æŒ‡æ•¸é€€é¿ç­–ç•¥æ­£ç¢º (FR-010)
- [ ] **å ´æ™¯ 7**: æ”¯æ´ 10+ å°è£ç½®,é¡¯ç¤ºæé†’è¨Šæ¯ (FR-016)
- [ ] **å ´æ™¯ 8**: æ­·å²è¨˜éŒ„æŸ¥è©¢æ•ˆèƒ½ < 100ms (Performance Goals)
- [ ] **å ´æ™¯ 9**: ç§é‘°ä¸æ´©éœ²,è³‡æ–™åŠ å¯†å‚³è¼¸ (FR-012, FR-013, FR-014)
- [ ] **å ´æ™¯ 10**: å››å€‹å¹³å° (Windows/macOS/Android/iPadOS) æ­£å¸¸é‹ä½œ (FR-003)

---

**æ¸¬è©¦å®Œæˆæ™‚é–“**: TBD (Phase 4 å¯¦ä½œå®Œæˆå¾Œ)
**æ¸¬è©¦åŸ·è¡Œè€…**: TBD
**æ¸¬è©¦ç’°å¢ƒ**: TBD

---

**ä¸‹ä¸€æ­¥**: åŸ·è¡Œ /tasks å‘½ä»¤ç”Ÿæˆå¯¦ä½œä»»å‹™æ¸…å–®
